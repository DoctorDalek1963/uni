% vim: set foldmethod=marker foldlevel=0:

\documentclass[a4paper, 11pt]{article}
\usepackage[UKenglish]{babel}

\usepackage[margin=2.4cm]{geometry}

\usepackage{preamble}

\renewcommand{\thesubsection}{\hspace*{-2.75em} (\alph{subsection})}

\fancyhead[L]{CS260 Assignment 1}
\title{CS260 Algorithms, Assignment 1}
\colorlet{questionbodycolor}{yellow!50!pink}

\begin{document}

% TODO: Comment out the question body before submitting

% Question body {{{

\maketitle

\setlength{\parindent}{0em}
\setlength{\parskip}{1em}

\fancyhead[C]{}

\pagenumbering{roman}

\question{1}

\begin{questionbody}
Daventry University has constructed a set of $n$ high-rise student accommodate towers, arranged in a straight line from west (left) to east (right).

Each tower has a roof deck. The tower roof decks with an uninterrupted view of the local beauty spots---Daventry reservoir (to the east) and Drayton reservoir (to the west)---are particularly prized.
\begin{enumerate}[(a)]
\item A tower roof deck has an uninterrupted view of Daventry reservoir if there is no taller tower to its east (i.e., to the right).

Suppose $n=8$ and the number of floors in each tower from west to east is $[12, 16, 4, 7, 12, 9, 5, 9]$. Which towers (labelling them $1, 2, \dotsc, 8$ from west to east) have an uninterrupted view of Daventry reservoir?

\item Given an array of $n$ towers, present a linear time algorithm that computes, for each tower, the height of the tallest tower to its east (right).

\item The most prized towers are those that have an uninterrupted view east to Daventry reservoir or an uninterrupted view west to Drayton reservoir. Design a linear time algorithm that reports which towers (if any) are either taller than all towers to the east (right) or taller than all towers to the west (left). Explain your solution. You may find it useful to build on your answer from part~\textbf{(b)}.
\end{enumerate}

Unfortunately, Daventry University does not have enough students to fill all the towers, and so must sell some of them. They decide to enforce the rule that if they sell a tower with $\ell$ floors, then they will also sell \textit{every} tower to its east (right) that has strictly fewer than $\ell$ floors. Define $D(i)$ as the total number of towers that will be sold off as a result of choosing to sell tower $i$.
\begin{enumerate}[(a), start=4]
\item Suppose $n=10$ and the number of floors in each tower from west to east is $[34, 57, 70, 19, 48, 2, 94, 7, 63, 75]$. Compute $D(i)$ for each tower $1, 2, \dotsc, 10$.

\item What is the optimal time cost of an algorithm that computes $D(i)$ for a given $i$, given an array $A$ of $n$ towers? Justify your answer.

\item A tower is said to be \textit{lower-value} if either it has no neighbour to the east, or the adjacent tower to the east has at least as many floors as it does. Give an $O(n)$ time algorithm to compute $D(i)$ for every tower listed in an array $A$ under the assumption that all but one of the towers are lower-value. Explain why your solution is correct.

\item Given an array $A$ representing the number of floors in each of the $n$ towers, design an $O(n \log n)$-time divide and conquer algorithm that computes $D(i)$ for all the towers. Explain the correctness of your algorithm.
\end{enumerate}
\end{questionbody}

\newpage
\pagenumbering{arabic}

% }}}

\setlength{\parindent}{0em}
\setlength{\parskip}{1em}

\fancyhead[C]{Page \thepage~of~\pageref*{last-page}}

\subsection{~} % a
\vspace*{-6.5ex}

Towers 2, 5, 6, and 8 have an uninterrupted view to the right.

\subsection{~} % b
\vspace*{-6.5ex}

\begin{verbatim}
max_east_heights = [0] * n
i = n
max = 0

while i >= 2
    if A[i] > max then
        max = A[i]

    max_east_heights[i - 1] = max
    i = i - 1
\end{verbatim}

\subsection{~} % c
\vspace*{-6.5ex}

\begin{verbatim}
view_to_left = []
view_to_right = []
max = 0

for i = 1 to n
    if A[i] > max then
        max = A[i]
        view_to_left.push(i)

max = 0
i = n
while i >= 1
    if A[i] > max then
        max = A[i]
        view_to_right.push(i)

    i = i - 1
\end{verbatim}

To find which towers have an uninterrupted view to the left, we scan the heights from left to right, keeping track of the maximum height so far. Any tower which is taller than the current maximum has an uninterrupted view, so we record its index and update the maximum. We do the same in reverse to find the towers with a view to the right.

\subsection{~} % d
\vspace*{-6.5ex}

[4, 5, 6, 3, 3, 1, 4, 1, 1, 1]

\subsection{~} % e
\vspace*{-6.5ex}

The optimal time cost to compute $D(i)$ is $O(n)$, since we only need to scan the towers array from $i+1$ to $n$ once and count how many towers are strictly shorter than the one we care about.

\subsection{~} % f
\vspace*{-6.5ex}

\begin{verbatim}
d = [1] * n

for i = 1 to n
    if A[i] > A[i + 1] then
        k = i
        break

j = n - 1
i = k

while i >= 0
    while A[j] >= A[i] and j > k
        j -= 1

    d[i] = 1 + j - k
    i -= 1
\end{verbatim}

Assuming all but one tower is lower-value tells that the towers form a sawtooth pattern with a single drop somewhere in the middle. Call the tallest tower before the drop index $k$ and split the list into left and right parts.

We scan the left part from right to left and keep track of an index $j$, which also moves from right to left. This tracks how many towers in the right half are shorter than the current tower. We only have to look for shorter towers in the right half because the left half is increasing before the drop.

\subsection{~} % g
\vspace*{-6.5ex}

\begin{verbatim}
d = [1] * n

function populate_d(l, r)
    if l == r then
        return

    m = (l + r) / 2
    populate_d(l, m)
    populate_d(m + 1, r)

    right_half = copy_slice(A, m + 1, r + 1)
    sort(right_half)

    for i = l to m + 1
        shorter = binary_search(right_half, A[i])
        d[i] = d[i] + shorter

populate_d(1, n)
\end{verbatim}

Recursively, we split the list into 2 parts at each step. When we merge, we sort the right half to find the index of the first shorter tower if it would exist (in Python this is \verb|bisect.bisect_left|). This index gives us the count of shorter towers.

\label{last-page} % chktex 24

\end{document}
