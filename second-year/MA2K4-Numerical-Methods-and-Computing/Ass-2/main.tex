% vim: set foldmethod=marker foldlevel=0:

\documentclass[a4paper]{article}
\usepackage[UKenglish]{babel}

\usepackage{preamble}

\def\erfi{\mathop{\rm erfi}\nolimits}

\fancyhead[L]{MA2K4 Assignment 2}
\title{MA2K4 Numerical Methods and Computing, Assignment 2}
\colorlet{questionbodycolor}{green!50}

\begin{document}

\maketitle

\setlength{\parindent}{0em}
\setlength{\parskip}{1em}

% {{{ Q1
\question{1}

\begin{questionbody}
Interpolate the function $f(x) = \sqrt x$ by a quadratic polynomial $p_2(x)$ with notes at $x_0 = 1$, $x_1 = 2$, and $x_2 = 3$. Isolate the coefficients in the polynomial. Further, compute the error at $x = 6$ to three significant digits.
\end{questionbody}

\begin{align*}
p_2(x) &= \sum_{k=0}^2 L_k(x) y_k \\[0.5ex]
&= \sum_{k=0}^2 L_k(x) \sqrt k \\[0.5ex]
&= L_0(x) \sqrt 1 + L_1(x) \sqrt 2 + L_2(x) \sqrt 3 \\[0.5ex]
&= L_0(x) + L_1(x) \sqrt 2 + L_2(x) \sqrt 3 \\[0.5ex]
&= \f{(x - x_1) (x - x_2)}{(x_0 - x_1) (x_0 - x_2)}
    + \f{(x - x_0) (x - x_2)}{(x_1 - x_0) (x_1 - x_2)} \sqrt 2
    + \f{(x - x_0) (x - x_1)}{(x_2 - x_0) (x_2 - x_1)} \sqrt 3 \\[0.5ex]
&= \f{(x - 2) (x - 3)}{(1 - 2) (1 - 3)}
    + \f{(x - 1) (x - 3)}{(2 - 1) (2 - 3)} \sqrt 2
    + \f{(x - 1) (x - 2)}{(3 - 1) (3 - 2)} \sqrt 3 \\[0.5ex]
&= \f{(x - 2) (x - 3)}{2}
    + \f{(x - 1) (x - 3)}{-1} \sqrt 2
    + \f{(x - 1) (x - 2)}{2} \sqrt 3 \\[0.5ex]
&= \f{x^2 - 5x + 6}{2}
    + \f{x^2 - 4x + 3}{-1} \sqrt 2
    + \f{x^2 - 3x + 2}{2} \sqrt 3 \\[0.5ex]
&= \f12 x^2 - \f52 x + 3
    - \sqrt 2 x^2 + 4\sqrt 2 x - 3 \sqrt 2
    + \f{\sqrt 3}2 x^2 - \f{3\sqrt 3}2 x + \sqrt 3 \\[0.5ex]
&= \l( \f12 - \sqrt 2 + \f{\sqrt 3}2 \r) x^2
    + \l( -\f52 + 4\sqrt 2 - \f{3\sqrt 3}2 \r) x
    + \l( 3 - 3 \sqrt 2 + \sqrt 3 \r)
\end{align*}

The interpolation error at $x=6$ is
\begin{align*}
f(6) - p_2(6) &= \sqrt 6 - \l( \f12 - \sqrt 2 + \f{\sqrt 3}2 \r) 6^2 \\
    &\qquad - \l( -\f52 + 4\sqrt 2 - \f{3\sqrt 3}2 \r) 6
    - \l( 3 - 3 \sqrt 2 + \sqrt 3 \r) \\[0.5ex]
&= \sqrt 6 - \l( 18 - 36 \sqrt 2 + 18 \sqrt 3 \r) \\
    &\qquad + 15 - 24 \sqrt 2 + 9\sqrt 3
    - 3 + 3 \sqrt 2 - \sqrt 3 \\[0.5ex]
&= \sqrt 6 - 18 + 36 \sqrt 2 - 18 \sqrt 3 \\
    &\qquad + 15 - 24 \sqrt 2 + 9\sqrt 3
    - 3 + 3 \sqrt 2 - \sqrt 3 \\[0.5ex]
&= -18 + 15 - 3
    + 36 \sqrt 2 - 24 \sqrt 2 + 3 \sqrt 2 \\
    &\qquad - 18 \sqrt 3 + 9\sqrt 3 - \sqrt 3 + \sqrt 6 \\[0.5ex]
&= -6 + 15 \sqrt 2 - 10 \sqrt 3 + \sqrt 6
\end{align*}
This computes to be 0.342 to 3 significant digits.

% }}}

% {{{ Q2
\newquestion{2}

\begin{questionbody}
The imaginary error function \[
\erfi(x) = \f2{\sqrt\pi} \intlim 0x {\e^{t^2}} t, \qquad x \in [0, 1],
\] is to be linearly interpolated at nodes $x_0, x_1 \in [0, 1]$ which are separated by a distance $h = x_1 - x_0$. What node spacing $h$ needs to be chosen to achieve an interpolation error smaller than $10^{-6}$?
\end{questionbody}

We know that the error is bounded by \[
|e(x)| \le \f{\| \erfi''(x) \|_\infty}{2!} \big| (x - x_0) (x - x_1) \big|
\] and
\begin{align*}
\erfi'(x) &= \e^{x^2}, \\
\erfi''(x) &= 2x \e^{x^2}.
\end{align*}
Since we're only working within $[0, 1]$, we can limit the $\infty$-norm to this interval so \[
\big\| 2x \e^{x^2} \big\|_\infty = 2 \cdot 1 \cdot \e^{1^2} = 2\e
\]

Therefore
\begin{align*}
|e(x)| &\le \f{2\e}2 \big| (x - x_0) (x - x_1) \big| \\
&= \e \big| (x - x_0) (x - x_1) \big|.
\end{align*}

To find the maximum of $(x - x_0) (x - x_1)$, let $\theta \in [0, 1]$ and write
\begin{align*}
x &= x_0 + \theta h, \\
x_1 &= x_0 + h.
\end{align*}
Then
\begin{align*}
\big| (x - x_0) (x - x_1) \big| &= \big| (x_0 + \theta h - x_0) (x_0 + \theta h - x_0 - h) \big| \\
&= \big| \theta h (\theta h - h) \big| \\
&= \big| \theta h^2 (\theta - 1) \big|.
\end{align*}
The maximum is obtained when $\theta = \f12$, giving $\f14 h^2$. Therefore \[
|e(x)| \le \f14 h^2 \e.
\]
We want
\begin{align*}
\f14 h^2 \e &< 10^{-6} \\
h &< \sqrt{4 \cdot 10^{-6} \e} \\
&\approx 0.00329744.
\end{align*}

% }}}

% {{{ Q3
\newquestion{3}

\begin{questionbody}
Consider $n + 2$ distinct nodes $x_i \in \R$, $i \in \{0, 1, \dotsc, n+1\}$, and the corresponding data values $y_i \in \R$, $i \in \{0, \dotsc, n+1\}$. Let $q(x)$ be the Lagrange interpolating polynomial of degree $n$ for the nodes and values $\{(x_i, y_i) : i = 0, 1, \dotsc, n\}$ and let $r(x)$ be the Lagrange interpolating polynomial of degree $n$ for the nodes and values $\{(x_i, y_i) : i = 1, 2, \dotsc, n+1\}$.

Define a new polynomial \[
p(x) = \f{(x - x_0) r(x) - (x - x_{n+1}) q(x)}{x_{n+1} - x_0}.
\] Show that this $p(x)$ is the Lagrange interpolation polynomial of degree $n+1$ for the nodes and values $\{(x_i, y_i) : i = 0, 1, \dotsc, n+1\}$.
\end{questionbody}

We know
\begin{align*}
q(x) &= \sum_{k=0}^{n} \prod_{j \ne k}^{n} \f{x - x_j}{x_k - x_j} y_k \\
r(x) &= \sum_{k=1}^{n+1} \prod_{j \ne 0, k}^{n+1} \f{x - x_j}{x_k - x_j} y_k \\
p(x) &= \sum_{k=0}^{n+1} \prod_{j \ne k}^{n+1} \f{x - x_j}{x_k - x_j} y_k
\end{align*}
so $q(x)$ is missing the $y_{n+1}$ term

\begin{align*}
p(x) &= \f{x - x_{n+1}}{x_k - x_{n+1}} q(x) + \prod_{j = 1}^{n} \f{x - x_j}{x_{n+1} - x_j} y_{n+1} \\
&= \f{x - x_0}{x_k - x_0} r(x) + \prod_{j \ne k}^{n} \f{x - x_j}{x_0 - x_j} y_0 \\
\end{align*}

% }}}

% {{{ Q4
\newquestion{4}

\begin{questionbody}
Given a function $f : [a, b] \to \R$, we make the following recursive definition:
\begin{align*}
f[a] &:= f(a), \\[0.5ex]
f[a, b] &:= \f{f[b] - f[a]}{b - a}, \\[0.5ex]
f[a, b, c] &:= \f{f[b, c] - f[a, b]}{c - a}, \\
&\ \ \vdots \\
f[a_0, \dotsc, a_n] &:= \f{f[a_1, \dotsc, a_n] - f[a_0, \dotsc, a_{n-1}]}{a_n - a_0}.
\end{align*}

Consider now $m+1$ distinct nodes $x_j \in \R$ for $j \in \{0, \dotsc, m\}$. Define the polynomial
\begin{align*}
q_0(x) &:= f(x_0), \\[0.5ex]
q_{k+1}(x) &:= q_k(x) + f[x_0, \dotsc, x_{k+1}] (x - x_0) (x - x_1) \dotsm (x - x_k).
\end{align*}
Show that the Lagrange interpolation polynomial of degree $m$, is in fact given by $p_m(x) = q_m(x)$.

\end{questionbody}

We will do proof by induction. Clearly $p_0(x) = f(x_0) = q_0(x)$ and
\begin{align*}
p_1(x) &= f(x_0) + \f{f(x_1) - f(x_0)}{x_1 - x_0} (x - x_0) \\
&= q_0(x) + \f{f[x_1] - f[x_0]}{x_1 - x_0} (x - x_0) \\
&= q_0(x) + f[x_0, x_1] (x - x_0),
\end{align*}
so we have our base case.

Assume $p_k(x) = q_k(x)$ for some fixed $k$.

% }}}

% {{{ Q5
\newquestion{5}

\begin{questionbody}
For the Newton--Cotes quadrature formula, using equally spaced points $x_j = a + \df jn (b - a)$, show that \[ % chktex 8
\alpha_j = \alpha_{n-j},
\] where $\alpha_j$ is the quadrature weight of the $j$th node.
\end{questionbody}

The weights are given by \[
\alpha_j = \intlim ab {L_j(x)} x,
\] where $L_j$ is the $j$th Lagrange polynomial \[
L_j(x) = \prod_{i \ne j}^m \f{x - x_i}{x_j - x_i}.
\]
We want to show that \[
\intlim ab {\prod_{i \ne j}^m \f{x - x_i}{x_j - x_i}} x = \intlim ab {\prod_{i \ne n - j}^m \f{x - x_i}{x_{n - j} - x_i}} x.
\]

Both integrands contain a factor of \[
\prod_{i \ne j, n - j}^k x - x_i,
\] which we can cancel, giving us \[
\l( \prod_{i \ne j}^m \f1{x_j - x_i} \r) \intlim ab {(x - x_{n-j})} x
    = \l( \prod_{i \ne n - j}^m \f1{x_{n - j} - x_i} \r) \intlim ab {(x - x_j)} x.
\] Then on the LHS, we get
\begin{align*}
\l( \prod_{i \ne j}^m \f1{x_j - x_i} \r) \intlim ab {(x - x_{n-j})} x
&= \l( \prod_{i \ne j}^m \f1{x_j - x_i} \r) {\l[ \f12 x^2 - x_{n - j} x \r]}_a^b \\[0.5ex]
&= \l( \prod_{i \ne j}^m \f1{x_j - x_i} \r) \l( \f{b^2}2 - x_{n-j} b - \f{a^2}2 + x_{n-j} a \r) \\[0.5ex]
&= \l( \prod_{i \ne j}^m \f1{x_j - x_i} \r) \l( \f12 (b^2 - a^2) + x_{n-j} (a - b) \r).
\end{align*}

Similarly on the RHS, we get \[
\l( \prod_{i \ne n-j}^m \f1{x_{n-j} - x_i} \r) \l( \f12 (b^2 - a^2) + x_{j} (a - b) \r).
\]

% TODO: Can we just argue by symmetry and avoid this direct stuff?

% }}}

\end{document}
