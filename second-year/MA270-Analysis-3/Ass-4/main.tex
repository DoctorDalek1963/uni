% vim: set foldmethod=marker foldlevel=0:

\documentclass[a4paper]{article}
\usepackage[UKenglish]{babel}

\usepackage{preamble}

\fancyhead[L]{MA270 Assignment 4}
\title{MA270 Analysis 3, Assignment 4}
\colorlet{questionbodycolor}{blue!50}

\begin{document}

\maketitle

\setlength{\parindent}{0em}
\setlength{\parskip}{1em}

% {{{ Q1
\question{1}

\begin{questionbody}
\textit{Definition}: A function $f : \R^2 \to \R$ is said to admit a global minimum at $(x_0, y_0)$ if $f(x_0, y_0) \le f(x_1, y_1)$ for every $(x_1, y_1) \in \R^2$. It is said to admit a unique global minimum if there exists $(x_0, y_0) \in \R^2$ such that $f$ admits a global minimum at $(x_0, y_0)$ and for every $(x_1, y_1) \in \R^2$, $f(x_0, y_0) = f(x_1, y_1)$ implies $x_0 = x_1$ and $y_0 = y_1$.

Let $f : \R^2 \to \R$ be defined by $f(x, y) = x^2 + y^2 - 2x - 4y$. Show that this function admits a unique global minimum on $\R^2$ and calculate the minimum of $f$.
%
% \textbf{Hint}: One may use Exercise~4 of the Week~9 Exercise Sheet.
\end{questionbody}

The shape of $f$ is a positive paraboloid so we expect a unique global minimum, which will be the only stationary point.
\begin{align*}
\nabla f(x, y)
&= \begin{pmatrix}
\partial_x f \\
\partial_y f
\end{pmatrix} \\[0.5ex]
&= \begin{pmatrix}
2x - 2 \\
2y - 4
\end{pmatrix}
\end{align*}
Clearly this equals $\ul 0$ only at $(1, 2)$, so this is our minimum point. The minimum value is
\begin{align*}
f(1, 2) &= 1^2 + 2^2 - 2 - 4(2) \\
&= 1 + 4 - 2 - 8 \\
&= -5.
\end{align*}

% }}}

% {{{ Q2
\newquestion{2}

\begin{questionbody}
Let $f: \R^2 \to \R$ be defined by $f(0, 0) = 0$ and $f(x, y) = \df{\sin(xy)}{|x| + |y|}$ if ${(x, y) \ne (0, 0)}$.
\begin{enumerate}[(a)]
\item Show that $f$ is continuous on $\R^2$.

\textbf{Hint}: To show continuity at zero, we can show $|f(x, y)| \le \min\{ |x|, |y| \}$ for every $(x, y) \in \R^2$ and to show this we can use the inequality $|\sin(x)| \le |x|$ valid for every $x \in \R$.

\item Show that for any $x \ge 0$, $\partial_2 f(x, 0)$ exists.

\item Show that $f$ is not continuously differentiable at $(0, 0)$.
\end{enumerate}
\end{questionbody}

\subsection{~} % 2.a

% TODO
I don't know how to do this, sorry.

\subsection{~} % 2.b

% $\partial_2 f(x, 0)$ is the second term in the gradient $\nabla f(x, 0)$, so we just need to find the gradient.
\begin{align*}
\partial_2 f &= \partial_y \l( \f{\sin(xy)}{|x| + |y|} \r) \\[0.5ex]
&= \partial_y \l( \sin(xy) {(|x| + |y|)}^{-1} \r) \\[0.5ex]
&= \sin(xy) \l( \partial_y {(|x| + |y|)}^{-1} \r) + {(|x| + |y|)}^{-1} \l( \partial_y \sin(xy) \r) \\[0.5ex]
&= \sin(xy) \l( - \op{sgn}(y) {(|x| + |y|)}^{-2} \r) + \f{x \cos(xy)}{|x| + |y|} \\[0.5ex]
&= \f{- \sin(xy) \op{sgn}(y)}{{(|x| + |y|)}^2} + \f{x \cos(xy)}{|x| + |y|} \\[1.5ex]
\partial_2 f(x, 0) &= -0 + \f{x \cos(0)}{|x| + 0} \\[0.5ex]
&= \f{x}{|x|} \\[0.5ex]
&= \op{sgn}(x)
\end{align*}
So $\partial_2 f(x, 0) = 1$ for all $x > 0$.

$f$ is constant $0$ along the $y$-axis, so $\partial_2 f(0, 0) = 0$. Therefore $\partial_2 f(x, 0)$ exists for any $x \ge 0$.

\subsection{~} % 2.c

By part~\textbf{(b)}, $\partial_2 f(x, 0) = -1$ for all $x < 0$. Therefore \[
\partial_2 f(x, 0) = \begin{cases}
1 & x > 0 \\
0 & x = 0 \\
-1 & x < 0
\end{cases},
\] so $\partial_2 f$ is not continuous along the $x$-axis and therefore cannot be continuously FrÃ©chet differentiable at $(0, 0)$.

% }}}

% {{{ Q3
\newquestion{3}

\begin{questionbody}
Let $A : \R^n \to \R^m$ be a fixed linear map, and define \[
f : \R^n \to \R, \qquad f(x) = {\| Ax \|}^2.
\]
\begin{enumerate}[(a)]
\item For any $h \in \R^n$, compute $D f(x) (h)$ in terms of $A$, $h$, and $x$.

\item Let $\gamma : \R \to \R^n$ be a $C^1$ curve. Use the chain rule to compute $\ds \diff t f(\gamma(t))$ in terms of $\gamma(t)$, $\gamma'(t)$, $A$ and $A^T$, where $A^T$ is by definition the unique linear map $\R^m \to \R^n$ satisfying $A^T x \cdot y = x \cdot A y$ for every $x \in \R^m$ and $y \in \R^n$.

\item Show that the critical points of $f$ (points where $\nabla f(x) = 0$) are precisely those $x$ with $Ax = 0$.
\end{enumerate}
\end{questionbody}

\subsection{~} % 3.a

We can use the relation between the Fr\'echet derivative and the directional derivative, and the definition of the directional derivative: \[
D f(x) (h) = \partial_h f(x) = \llim{t \to 0} \f{f(x + th) - f(x)}{t}.
\] Then we just compute
\begin{align*}
D f(x) (h) &= \llim{t \to 0} \f{f(x + th) - f(x)}{t} \\[0.5ex]
&= \llim{t \to 0} \f{{\| A(x + th) \|}^2 - {\| Ax \|}^2}{t} \\[0.5ex]
&= \llim{t \to 0} \f{{\| Ax + tAh \|}^2 - {\| Ax \|}^2}{t} \\[0.5ex]
&= \llim{t \to 0} \f{{\| Ax \|}^2 + 2 |t| \| Ax \| \| Ah \| + {|t|}^2 {\| Ah \|}^2 - {\| Ax \|}^2}{t} \\[0.5ex]
&= \llim{t \to 0} \l( 2 \, {\| Ax \|}^2 {\| Ah \|}^2 + |t| \, {\| Ah \|}^2 \r) \\[0.5ex]
&= 2 \, {\| Ax \|}^2 {\| Ah \|}^2 \\[0.5ex]
&= 2 f(x) f(h)
\end{align*}

\subsection{~} % 3.b

By Example~6.24 in the notes,
\begin{align*}
% \diff t f(\gamma(t)) &= \l. \dd ft \r|_{\gamma(t)} \cdot \gamma'(t) \\[0.5ex]
% \dd ft &= \pdd f{x_0} \dd {x_0}t
% D (f \circ \gamma)(t) &= D f(\gamma(t)) \circ D \gamma(t) \\[0.5ex]
% &= D f(\gamma(t)) \circ \gamma'(t) \\[0.5ex]
\diff t f(\gamma(t)) &= \nabla f(\gamma(t)) \cdot \gamma'(t) \\[0.5ex]
% TODO: This is wrong
&= A(\gamma(t)) \cdot \gamma'(t)
\end{align*}

\subsection{~} % 3.c

% TODO: Justify this
The points where $\nabla f(x) = 0$ are the points where $f(x) = 0$, and so $Ax = 0$.

% }}}

% {{{ Q4
\question{4}

\begin{questionbody}
\textit{Definition}: A function $f : \R^n \to \R^k$ is said to be $L$-Lipschitz for a constant $L \ge 0$ if for every $x, y \in \R^n$, $\| f(x) - f(y) \| \le L \| x - y \|$.

Let $f : \R^n \to \R$ be a $C^1$ function (i.e.\ continuously differentiable). Suppose that there exists a constant $L \ge 0$ such that for every $x \in \R^n$, we have $\| \nabla f(x) \| \le L$.
\begin{enumerate}[(a)]
\item Let $x, y \in \R^n$. Show that \[
\intlim 01 {\nabla f(x + t(y - x)) \cdot (y - x)} t = f(y) - f(x).
\]

\item Deduce that $f$ is $L$-Lipschitz.
\end{enumerate}
\end{questionbody}

\subsection{~} % 4.a

% TODO

\begin{align*}
\intlim 01 {\nabla f(x + t(y - x)) \cdot (y - x)} t &= \intlim 01 {\sum_{i=1}^n (y_i - x_i) \, \partial_i f(x_i + t(y_i - x_i))} t \\[0.5ex]
&= \sum_{i=1}^n (y_i - x_i) \intlim 01 {\partial_i f(x_i + t(y_i - x_i))} t \\[0.5ex]
\end{align*}
I'm lost, sorry.

% TODO
% \subsection{~} % 4.b

% Answer

% }}}

\end{document}
