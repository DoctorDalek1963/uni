% vim: set foldmethod=marker foldlevel=0:

\documentclass[a4paper]{article}
\usepackage[UKenglish]{babel}

\usepackage[hidelinks]{hyperref}

\usepackage{preamble}

\renewcommand{\thesubsection}{Q\arabic{section}~(\roman{subsection})}

\fancyhead[L]{MA265 Assignment 3}
\title{MA265 Methods of Mathematical Modelling 3, Assignment 3}
\colorlet{questionbodycolor}{green!50!teal!50}

\begin{document}

\maketitle

\setlength{\parindent}{0em}
\setlength{\parskip}{1em}

% {{{ Q1
\question{1}

\begin{questionbody}
\textit{Fourier series}: For integers $m$ and $n$, show that
\begin{align*}
\intlim {-\pi}{\pi} {\sin(mx) \sin(nx)} x &= \begin{cases}
\pi & \text{if } m = n \\
0 & \text{otherwise},
\end{cases}\\
%
\intlim {-\pi}{\pi} {\cos(mx) \cos(nx)} x &= \begin{cases}
\pi & \text{if } m = n \\
0 & \text{otherwise},
\end{cases}\\
%
\intertext{and}
\intlim {-\pi}{\pi} {\sin(mx) \cos(nx)} x &= 0 \quad \text{for all } m \text{ and } n.
\end{align*}
Consider the function $\phi(x) = x$ on $[-\pi, \pi]$. Assuming $\phi$ can be written in the form
\begin{equation}
\phi(x) = a_0 + \sum_{k=1}^\infty a_k \cos(kx) + b_k \sin(kx), \label{eqn:Q1-phi-as-sum}
\end{equation}
find the values of the coefficients $a_k$ and $b_k$.

% \textbf{Hint}: To find the coefficients $a_k$, multiply~\eqref{eqn:Q1-phi-as-sum} by $\cos(nx)$, integrate $[-\pi, \pi]$ and use the above relations. The coefficients $b_k$ can be computed following the same strategy, but multiplying by $\sin(nx)$.
\end{questionbody}

We will first consider the integral of $\sin(mx) \sin(nx)$. If $m=n$, the integral becomes
{\allowdisplaybreaks{}
\begin{align*}
\intlim {-\pi}{\pi} {\sin(mx) \sin(nx)} x &= \intlim {-\pi}{\pi} {\sin^2(nx)} x \\[0.5ex]
&= \f12 \intlim {-\pi}{\pi} {(1 - \cos(2nx))} x \\[0.5ex]
&= \f12 {\l[ x - \f1{2n} \sin(2nx) \r]}_{-\pi}^\pi \\[0.5ex]
&= \f12 \l( \pi - \f1{2n} \sin(2n\pi) - \l( -\pi - \f1{2n} \sin(-2n\pi) \r) \r) \\[0.5ex]
&= \f12 \l( \pi - \f1{2n} \sin(2n\pi) + \pi + \f1{2n} \sin(-2n\pi) \r) \\[0.5ex]
&= \f12 \l( 2\pi - \f1{2n} \sin(2n\pi) - \f1{2n} \sin(2n\pi) \r) \\[0.5ex]
&= \pi.
\end{align*}
}

If instead $m \ne n$, we get
\begin{align*}
\intlim {-\pi}{\pi} {\sin(mx) \sin(nx)} x &= \intlim {-\pi}{\pi} {\f{-\cos(mx + nx) + \cos(mx - nx)}{2}} x \\[0.5ex]
&= \f12 {\l[ \f{-1}{m+n} \sin(mx + nx) + \f1{m-n} \sin(mx - nx) \r]}_{-\pi}^\pi \\[0.5ex]
&= \f12 \bigg( \f{-1}{m+n} \sin((m+n)\pi) + \f1{m-n} \sin((m-n)\pi)
    \\ &\qquad + \f1{m+n} \sin(-(m+n)\pi) - \f1{m-n} \sin(-(m-n)\pi) \bigg) \\[0.5ex]
&= 0
\end{align*}
since $m+n$ and $m-n$ are always integers, so $\sin((m+n)\pi)$ etc.\ are all 0.

We will now consider the integral of $\cos(mx) \cos(nx)$. As before, if $m=n$, the integral becomes
\begin{align*}
\intlim {-\pi}{\pi} {\cos(mx) \cos(nx)} x &= \intlim {-\pi}{\pi} {\cos^2(nx)} x \\[0.5ex]
&= \f12 \intlim {-\pi}{\pi} {(1 + \cos(2nx))} x \\[0.5ex]
&= \f12 {\l[ x + \f1{2n} \sin(2nx) \r]}_{-\pi}^\pi \\[0.5ex]
&= \f12 \l( \pi + \f1{2n} \sin(2n\pi) - \l( -\pi + \f1{2n} \sin(-2n\pi) \r) \r) \\[0.5ex]
&= \f12 \l( \pi + \f1{2n} \sin(2n\pi) + \pi - \f1{2n} \sin(-2n\pi) \r) \\[0.5ex]
&= \f12 \l( 2\pi + \f1{2n} \sin(2n\pi) + \f1{2n} \sin(2n\pi) \r) \\[0.5ex]
&= \pi + \f1{2n} \sin(2n\pi) \\[0.5ex]
&= \pi
\end{align*}
since $n \in \Z$, so $\sin(2n\pi)$ is always 0.

If instead $m \ne n$, we get
\begin{align*}
\intlim {-\pi}{\pi} {\cos(mx) \cos(nx)} x &= \intlim {-\pi}{\pi} {\f{\cos(mx + nx) + \cos(mx - nx)}{2}} x \\[0.5ex]
&= \f12 {\l[ \f1{m+n} \sin(mx + nx) + \f1{m-n} \sin(mx - nx) \r]}_{-\pi}^\pi \\[0.5ex]
&= \f12 \bigg( \f1{m+n} \sin((m+n)\pi) + \f1{m-n} \sin((m-n)\pi)
    \\ &\qquad - \f1{m+n} \sin(-(m+n)\pi) - \f1{m-n} \sin(-(m-n)\pi) \bigg) \\[0.5ex]
&= 0
\end{align*}
since $m+n$ and $m-n$ are always integers, so $\sin((m+n)\pi)$ etc.\ are all 0.

We will now consider the integral of $\sin(mx) \cos(nx)$. For any $m$ and $n$,
\begin{align*}
\intlim {-\pi}{\pi} {\sin(mx) \cos(nx)} x &= \intlim {-\pi}{\pi} {\f{\sin(mx + nx) + \sin(mx - nx)}{2}} x \\[0.5ex]
&= \f12 {\l[ \f{-1}{m+n} \cos(mx + nx) - \f1{m-n} \cos(mx - nx) \r]}_{-\pi}^\pi \\[0.5ex]
&= \f12 \bigg( \f{-1}{m+n} \cos((m + n)\pi) - \f1{m-n} \cos((m - n)\pi)
    \\ &\qquad + \f1{m+n} \cos(-(m + n)\pi) + \f1{m-n} \cos(-(m - n)\pi) \bigg) \\[0.5ex]
&= \f12 \bigg( \f{-1}{m+n} \cos((m + n)\pi) - \f1{m-n} \cos((m - n)\pi)
    \\ &\qquad + \f1{m+n} \cos((m + n)\pi) + \f1{m-n} \cos((m - n)\pi) \bigg) \\[0.5ex]
&=0.
\end{align*}

To find $a_k$ in the Fourier series for $\phi$, we can multiply both sides by $\cos(nx)$ and integrate. On the LHS, we get
\begin{align*}
\intlim {-\pi}{\pi} {x \cos(nx)} x &= {\l[ \f{nx \sin(nx) + \cos(nx)}{n^2} \r]}_{-\pi}^\pi \\[0.5ex]
&= \f{n\pi \sin(n\pi) + \cos(n\pi) - \big( -n\pi \sin(-n\pi) + \cos(-n\pi) \big)}{n^2} \\[0.5ex]
&= \f{n\pi \sin(n\pi) + n\pi \sin(-n\pi) + \cos(n\pi) - \cos(-n\pi)}{n^2} \\[0.5ex]
&= \f{n\pi \sin(n\pi) - n\pi \sin(n\pi) + \cos(n\pi) - \cos(n\pi)}{n^2} \\[0.5ex]
&= 0.
\end{align*}
On the RHS, we get
\begin{align*}
a_0 &\cos(nx) + \sum_{k=1}^\infty a_k \cos(kx) \cos(nx) + b_k \sin(kx) \cos(nx) \\[0.5ex]
%
&= \intlim {-\pi}{\pi} {\l(
    a_0 \cos(nx)
    + \sum_{k=1}^\infty a_k \cos(kx) \cos(nx)
    + b_k \sin(kx) \cos(nx)
\r)} x \\[0.5ex]
%
&= a_0 \intlim {-\pi}{\pi} {\cos(nx)} x + \sum_{k=1}^\infty \bigg(
    a_k \intlim {-\pi}{\pi} {\cos(kx) \cos(nx)} x
    \\ &\qquad + b_k \intlim {-\pi}{\pi} {\sin(kx) \cos(nx)} x
\bigg) \\[0.5ex]
%
&= 0 + \sum_{k=1}^\infty a_k \intlim {-\pi}{\pi} {\cos(kx) \cos(nx)} x \\[0.5ex]
&= 0 a_0 + 0 a_1 + \dotsb + 0 a_{n-1} + \pi a_n + 0 a_{n+1} \dotsb \\[0.5ex]
&= \pi a_n.
\end{align*}
So $a_n = 0$.

We can do the same to find $b_k$, but with $\sin(nx)$. On the LHS, we get
\begin{align*}
\intlim {-\pi}{\pi} {x \sin(nx)} x &= {\l[ \f{\sin(nx) - nx \cos(nx)}{n^2} \r]}_{-\pi}^\pi \\[0.5ex]
&= \f{\sin(n\pi) - n\pi \cos(n\pi) - \big( \sin(-n\pi) - n(-\pi) \cos(-n\pi) \big)}{n^2} \\[0.5ex]
&= \f{\sin(n\pi) - \sin(-n\pi) - n\pi \cos(n\pi) - n\pi \cos(-n\pi)}{n^2} \\[0.5ex]
&= \f{\sin(n\pi) + \sin(n\pi) - n\pi \cos(n\pi) - n\pi \cos(n\pi)}{n^2} \\[0.5ex]
&= \f{2\sin(n\pi) - 2n\pi \cos(n\pi)}{n^2}.
\end{align*}
On the RHS, we get
\begin{align*}
a_0 &\sin(nx) + \sum_{k=1}^\infty a_k \cos(kx) \sin(nx) + b_k \sin(kx) \sin(nx) \\[0.5ex]
%
&= \intlim {-\pi}{\pi} {\Bigg(
    a_0 \sin(nx)
    + \sum_{k=1}^\infty a_k \cos(kx) \sin(nx)
    + b_k \sin(kx) \sin(nx)
\Bigg)} x \\[0.5ex]
%
&= a_0 \intlim {-\pi}{\pi} {\sin(nx)} x + \sum_{k=1}^\infty \bigg( a_k \intlim {-\pi}{\pi} {\cos(kx) \sin(nx)} x
    \\ &\qquad + b_k \intlim {-\pi}{\pi} {\sin(kx) \sin(nx)} x \bigg) \\[0.5ex]
%
&= 0 + \sum_{k=1}^\infty b_k \intlim {-\pi}{\pi} {\sin(kx) \sin(nx)} x\\[0.5ex]
&= 0 b_0 + 0 b_1 + \dotsb + 0 b_{n-1} + \pi b_n + 0 b_{n+1} \dotsb \\[0.5ex]
&= \pi b_n.
\end{align*}
So $b_n = \df{2\sin(n\pi) - 2n\pi \cos(n\pi)}{n^2 \pi}$.

% }}}

% {{{ Q2
\newquestion{2}

\begin{questionbody}
\textit{Fourier series}: Let $\phi : [-\pi, \pi] \to \R$ be an even function. Prove that ${\hat \phi(k) = \hat \phi(-k)}$. Further, show that the Fourier~series of $\phi$ is a cosine series, in the sense that \[
S_n[\phi](x) = \hat \phi(0) + 2 \sum_{k=1}^n \hat \phi(k) \cos(kx).
\]
\end{questionbody}

With the substitution $y = -x$,
\begin{align*}
\hat\phi(k) &= \f1{2\pi} \intlim {-\pi}{\pi} {\phi(x) \e^{-ikx}} x \\[0.5ex]
&= \f1{2\pi} \intlim {\pi}{-\pi} {\phi(-y) \e^{iky}(-\!\!} {y)} \\[0.5ex] % chktex 9
&= \f1{2\pi} \intlim {-\pi}{\pi} {\phi(-y) \e^{iky}} y \\[0.5ex]
&= \f1{2\pi} \intlim {-\pi}{\pi} {\phi(y) \e^{-i(-k)y}} y \\[0.5ex]
&= \hat\phi(-k).
\end{align*}
Therefore, using de~Moivre's theorem,
\begin{align*}
S_n[\phi](x) &= \sum_{k = -n}^n \hat\phi(k) \e^{ikx} \\[0.5ex]
&= \hat\phi(0) + \sum_{k=1}^n \l( \hat\phi(k) \e^{ikx} + \hat\phi(-k) \e^{-ikx} \r) \\[0.5ex]
&= \hat\phi(0) + \sum_{k=1}^n \hat\phi(k) \l( \e^{ikx} + \e^{-ikx} \r) \\[0.5ex]
&= \hat\phi(0) + \sum_{k=1}^n \hat\phi(k) 2 \cos(kx) \\[0.5ex]
&= \hat\phi(0) + 2 \sum_{k=1}^n \hat\phi(k) \cos(kx).
\end{align*}

\hfill $\square$

% }}}

% {{{ Q3
\newquestion{3}

\begin{questionbody}
\textit{Wave equation with inhomogeneous boundary conditions}: Consider the boundary value problem:
\begin{equation}
\begin{cases}
\partial_{tt} u(x, t) = \partial_{xx} u(x, t) & (x, t) \in (0, \pi) \times (0, \infty), \\
u(0, t) = -2 & t \in [0, \infty), \\ % chktex 9
u(\pi, t) = 1 & t \in [0, \infty). % chktex 9
\end{cases} \label{eqn:Q3-boundary-value-problem}
\end{equation}
%
\begin{enumerate}[(i)]
\item Verify that \[
\overline u(x) = -2 + \f3\pi x
\] is a stationary solution of the problem (i.e.\ one that does not depend on $t$).

\item Assume now the initial conditions
\begin{align*}
u(x, 0) &= \Phi(x) = \f3\pi x - 2 + 5 \sin(2x), \\[0.5ex]
\partial_t u(x, 0) &= V(x) = \f12 \sin(4x) + \f13 \sin(11x).
\end{align*}
Let $w(x, t)$ be the function such that $u(x, t) = \overline u(x) + w(x, t)$. State the initial boundary value problem satisfied by $w$.

\item Solve the initial boundary value problem for $w$, using the general form of the solution \[
w(x, t) = \sum_{j=0}^\infty \Big( A_j \cos(jt) + B_j \sin(jt) \Big) \sin(jx).
\] Then, state the solution $u(x, t)$ of~\eqref{eqn:Q3-boundary-value-problem}.
\end{enumerate}
\end{questionbody}

\subsection{~} % 3.i

Since $\overline u$ does not depend on $t$, $\partial_{tt} \overline u = \partial_t \overline u = 0$. It is trivial to check that $\overline u$ satisfies the initial boundary conditions $\overline u(0) = -2$ and $\overline u(\pi) = 1$. Also \[
\partial_x \overline u(x) = \f3\pi, \qquad \partial_{xx} \overline u(x) = 0,
\] and so $\partial_{tt} \overline u = \partial_{xx} \overline u$. Therefore $\overline u$ is a stationary solution to~\eqref{eqn:Q3-boundary-value-problem}.

\subsection{~} % 3.ii

\begin{equation*}
\begin{cases}
\partial_{tt} w(x, t) = \partial_{xx} w(x, t) & (x, t) \in (0, \pi) \times (0, \infty), \\
w(0, t) = 0 & t \in [0, \infty), \\ % chktex 9
w(\pi, t) = 0 & t \in [0, \infty), \\ % chktex 9
w(x, 0) = 5 \sin(2x) & x \in (0, \pi), \\
\partial_t(x, 0) = \f12 \sin(4x) + \f13 \sin(11x) & x \in (0, \pi).
\end{cases}
\end{equation*}

\subsection{~} % 3.iii

Let \[
w(x, t) = \sum_{j=0}^\infty \Big( A_j \cos(jt) + B_j \sin(jt) \Big) \sin(jx).
\]
This satisfies the conditions $w(0, t) = 0$ and $w(\pi, t) = 0$ because ${\sin 0 = \sin \pi = 0}$, so the $\sin(jx)$ term annihilates the rest.

For the condition $w(x, 0) = 5 \sin(2x)$, we have
\begin{align*}
w(x, 0) &= \sum_{j=0}^\infty \Big( A_j \cos(0) + B_j \sin(0) \Big) \sin(jx) \\[0.5ex]
&= \sum_{j=0}^\infty A_j \sin(jx) \\[0.5ex]
&= 5 \sin(2x)
\end{align*}
which means that $A_2 = 5$ and $A_j = 0$ for all $j \ne 2$.

The derivatives are
\begin{align*}
\partial_t w(x, t) &= \sum_{j=0}^\infty \Big( -j A_j \sin(jt) + j B_j \cos(jt) \Big) \sin(jx) \\[1.5ex]
%
\partial_{tt} w(x, t) &= \sum_{j=0}^\infty \Big( -j^2 A_j \cos(jt) - j^2 B_j \sin(jt) \Big) \sin(jx) \\[1.5ex]
%
\partial_x w(x, t) &= \sum_{j=0}^\infty \Big( A_j \cos(jt) + B_j \sin(jt) \Big) j \cos(jx) \\[1.5ex]
%
\partial_{xx} w(x, t) &= \sum_{j=0}^\infty \Big( A_j \cos(jt) + B_j \sin(jt) \Big) (-j^2) \sin(jx)
\end{align*}
So clearly $\partial_{tt} w = \partial_{xx} w$. Also to satisfy the final condition, we need
\begin{align*}
\partial_t w(x, 0) &= \sum_{j=0}^\infty \Big( -j A_j \sin(0) + j B_j \cos(0) \Big) \sin(jx) \\[0.5ex]
&= \sum_{j=0}^\infty j B_j \sin(jx) \\[0.5ex]
&= \f12 \sin(4x) + \f13 \sin(11x)
\end{align*}
which means that $4 B_4 = \f12$ so $B_4 = 2$, and $11 B_{11} = \f13$ so $B_{11} = \f{11}3$, and $B_j = 0$ for all $b \notin \{4, 11\}$.

Therefore \[
w(x, t) = 5 \cos(2t) \sin(2x) + 2 \sin(4t) \sin(4x) + \f{11}3 \sin(11t) \sin(11x)
\] and therefore \[
u(x, t) = -2 + \f3\pi x + 5 \cos(2t) \sin(2x) + 2 \sin(4t) \sin(4x) + \f{11}3 \sin(11t) \sin(11x).
\]

% }}}

% {{{ Q4
\newquestion{4}

\begin{questionbody}
\textit{Fourier series}: Let $a \in \R \setminus \Z$. Compute the Fourier~series of \[
\phi_a(x) = \f\pi{\sin(\pi a)} \e^{-iax}.
\] Then, assuming that \[
\llim{n \to \infty} \intlim {-\pi}{\pi} {{\big| \phi_a(x) - S_n[\phi_a](x) \big|}^2} x = 0,
\] such that Parseval's~identity holds, deduce that \[
\sum_{k \in \Z} \f1{{(k + a)}^2} = \f{\pi^2}{\sin^2(\pi a)}.
\]
\end{questionbody}

The coefficients are
\begin{align*}
{\hat\phi}_a(k) &= \f1{2\pi} \intlim {-\pi}{\pi} {\phi_a(x) \e^{-ikx}} x \\[0.5ex]
&= \f1{2\pi} \intlim {-\pi}{\pi} {\f\pi{\sin(\pi a)} \e^{-iax} \e^{-ikx}} x \\[0.5ex]
&= \f1{2 \sin(\pi a)} \intlim {-\pi}{\pi} {\e^{-i(a+k)x}} x \\[0.5ex]
&= \f1{2 \sin(\pi a)} {\l[ \f{\e^{-i(a+k)x}}{-i (a+k)} \r]}_{-\pi}^\pi \\[0.5ex]
&= \f{i}{2 \sin(\pi a)} \, \f{\e^{-i(a+k)\pi} - \e^{i(a+k)\pi}}{(a+k)} \\[0.5ex]
&= \f{i \l( \e^{-i(a+k)\pi} - \e^{i(a+k)\pi} \r)}{2 (a+k) \sin(\pi a)} \\[0.5ex]
&= \f{i \big( -2i \sinh(i (a+k) \pi) \big)}{2 (a+k) \sin(\pi a)} \\[0.5ex]
&= \f{\sinh(i (a+k) \pi)}{(a+k) \sin(\pi a)} \\[0.5ex]
&= \f{\sin((a+k) \pi)}{(a+k) \sin(\pi a)}. % As per WolframAlpha
\end{align*}
Therefore
\begin{align*}
S_n[\phi_a](x) &= \sum_{k=-n}^n \hat\phi(k) \, \e^{-ikx} \\[0.5ex]
&= \sum_{k=-n}^n \f{\sin((a+k) \pi) \, \e^{-ikx}}{(a+k) \sin(\pi a)}.
\end{align*}

Parseval's identity says \[
\intlim {-\pi}{\pi} {{| \phi_a(x) |}^2} x = 2\pi \sum_{k \in \Z} {\l| {\hat\phi}_a(k) \r|}^2.
\]
And so we get
\begin{align*}
\intlim {-\pi}{\pi} {{\l| \f\pi{\sin(\pi a)} \e^{-iax} \r|}^2} x
    &= 2\pi \sum_{k \in \Z} {\l| \f{\sin((a+k) \pi)}{(a+k) \sin(\pi a)} \r|}^2 \\[0.5ex]
\f{\pi^2}{\sin^2(\pi a)} \intlim {-\pi}{\pi} {{\l| \e^{-iax} \r|}^2} x
    &= 2\pi \f1{\sin^2(\pi a)} \sum_{k \in \Z} \f{\sin^2((a+k) \pi)}{{(a+k)}^2} \\[0.5ex]
\f{\pi^2}{\sin^2(\pi a)} \intlim {-\pi}{\pi} 1 x
    &= \f{2\pi}{\sin^2(\pi a)} \sum_{k \in \Z} \f{{(\sin(a\pi + k\pi))}^2}{{(a+k)}^2} \\[0.5ex]
\pi^2 (2\pi) &= 2\pi \sum_{k \in \Z} \f{{\big( \sin(a\pi) \cos(k\pi) + \cos(a\pi) \sin(k\pi) \big)}^2}{{(a+k)}^2} \\[0.5ex]
\pi^2 &= \sum_{k \in \Z} \f{\sin^2(a\pi) \cos^2(k\pi)}{{(a+k)}^2} \\[0.5ex]
\pi^2 &= \sum_{k \in \Z} \f{\sin^2(a\pi)}{{(a+k)}^2} \\[0.5ex]
\f{\pi^2}{\sin^2(a\pi)} &= \sum_{k \in \Z} \f1{{(a+k)}^2}
\end{align*}

\hfill $\square$

% }}}

\end{document} % chktex 17
